<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="../css/style.css">
    <title>CV - Diego Mendoza</title>
    <style>
        :root {
            --bg: #fafafa;
            --toolbar: #f3f3f3;
            --btn: #2d6cdf;
            --btn-text: #fff
        }

        html, body {
            height: 100%;
            margin: 0;
            font-family: system-ui,Segoe UI,Roboto,Arial
        }

        .container {
            height: 100%;
            display: flex;
            flex-direction: column
        }

        .toolbar {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-bottom: 1px solid #ddd;
            background: var(--toolbar);
        }

        .title {
            font-weight: 600
        }

        .spacer {
            flex: 1
        }

        .viewer {
            flex: 1;
            background: #ddd;
            display: block;
            min-height: 0
        }
            /* min-height for flex children */
            .viewer embed, .viewer object, .viewer iframe {
                width: 100%;
                height: 100%;
                border: 0;
                display: block;
            }

        .btn {
            background: var(--btn);
            color: var(--btn-text);
            border: 0;
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .link {
            text-decoration: none;
            color: var(--btn-text);
        }

        .note {
            font-size: 12px;
            color: #666
        }
        /* responsive: on very small screens hide toolbar extras */
        @media (max-width:420px) {
            .toolbar .title {
                font-size: 14px
            }
        }
    </style>
</head>
<body>
    <script src="../js/language.js"></script>
    <div class="container">
        <div class="menu-bar">
            <span id="openBtn" title="Open in a new tab" data-translate="cv-open">Open</span>
            <span id="dlBtn" title="Download CV" data-translate="cv-download">Download</span>

            <div class="spacer"></div>


        </div>

        <div class="viewer" id="viewer">
            <!-- Embed principal (en navegadores compatibles mostrará el PDF) -->
            <embed id="pdfEmbed" src="../files/cv.pdf" type="application/pdf">

            <!-- fallback object -->
            <object id="pdfObject" data="../files/cv.pdf" type="application/pdf" aria-label="CV" style="display:none;">
                <p style="padding:12px" data-translate="cv-fallback">
                    Tu navegador no puede mostrar PDFs dentro del visor.
                    <a id="dlFallback" href="../files/cv.pdf" target="_blank" rel="noopener" data-translate="cv-fallback-link">Haz clic aquí para descargar el CV</a>
                </p>
            </object>
        </div>
    </div>

    <script>
    // Ruta del PDF (ajusta si tu PDF está en otra carpeta)
    const PDF_URL = '../files/cv.pdf';

    const embed = document.getElementById('pdfEmbed');
    const obj = document.getElementById('pdfObject');

    // Detect basic support: si embed.error o no soportado -> mostrar fallback object
    function ensureViewer() {
      // Algunos navegadores (móviles) no muestran embed: si embed.height==0 o embedd failed, fallback.
      // No hay un evento universal, así que probamos a detectar si el embed se renderiza.
      setTimeout(() => {
        const embedRect = embed.getBoundingClientRect ? embed.getBoundingClientRect() : null;
        const embedVisible = embedRect && embedRect.width > 0 && embedRect.height > 0;
        if (!embedVisible) {
          // intenta mostrar object
          embed.style.display = 'none';
          obj.style.display = 'block';
          obj.data = PDF_URL;
        } else {
          embed.style.display = 'block';
          obj.style.display = 'none';
        }
      }, 200);
    }

    ensureViewer();

    // Botón descargar
    document.getElementById('dlBtn').addEventListener('click', () => {
      const a = document.createElement('a');
      a.href = PDF_URL;
      a.download = 'CV-Diego-Mendoza.pdf';
      document.body.appendChild(a);
      a.click();
      a.remove();
    });

    // Botón abrir en nueva pestaña (útil en móviles que no renderizan inline)
    document.getElementById('openBtn').addEventListener('click', () => {
      window.open(PDF_URL, '_blank', 'noopener');
    });

    // Si quieres forzar viewer en mobile a abrir en nueva pestaña:
    if (/Mobi|Android|iPhone|iPad/i.test(navigator.userAgent)) {
      // opcional: comentar la siguiente línea si prefieres intentar mostrar inline en móviles
      // window.open(PDF_URL, '_blank', 'noopener');
    }
    </script>
</body>
</html>
